{"ast":null,"code":"var _jsxFileName = \"/Users/ibrahimfarajzade/Documents/GitHub/SeniorProject/WebPortal/src/routes/portalUsers.js\";\nimport React from \"react\";\nimport UsersListDisplay from \"../components/UsersListDisplay\";\nimport { getUserList } from \"../javascript/api\";\nimport Header from \"../components/Header\";\nimport Overlay from \"../components/Overlay\";\nimport { message, Button } from \"antd\";\nimport TextField from '@material-ui/core/TextField';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\n\nconst moment = require(\"moment\");\n\nclass PortalUsersPage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      awaitingData: true,\n      users: null,\n      page: 0\n    };\n  }\n\n  async componentDidMount() {\n    let json = await getUserList(message);\n    this.setState({\n      awaitingData: false,\n      users: json\n    });\n  }\n\n  render() {\n    let userData = this.state.users;\n\n    if (this.props.filter && this.state.users) {\n      userData = doFilter(this.state.users, this.props.filter);\n\n      if (userData.length > 0) {\n        message.success({\n          content: `Found ${userData.length} matching records`,\n          duration: 3\n        });\n      } else {\n        message.warn({\n          content: `No records found`,\n          duration: 3\n        });\n      }\n    }\n\n    const state = {\n      isOpen: false\n    };\n\n    const handleClickOpen = () => {\n      state.isOpen(true);\n    };\n\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 53\n      },\n      __self: this\n    }, React.createElement(Overlay, {\n      show: this.state.awaitingData,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 54\n      },\n      __self: this\n    }), !this.props.filter && React.createElement(Header, {\n      title: \"Portal Users List\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55\n      },\n      __self: this\n    }), React.createElement(Button, {\n      style: {\n        margin: 10,\n        marginTop: -10\n      },\n      type: \"primary\",\n      htmlType: \"submit\",\n      onClick: handleClickOpen,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 56\n      },\n      __self: this\n    }, \"Add User\"), React.createElement(Dialog, {\n      \"aria-labelledby\": \"form-dialog-title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59\n      },\n      __self: this\n    }, React.createElement(DialogTitle, {\n      id: \"form-dialog-title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60\n      },\n      __self: this\n    }, \"Subscribe\"), React.createElement(DialogContent, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61\n      },\n      __self: this\n    }, React.createElement(DialogContentText, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62\n      },\n      __self: this\n    }, \"To send invitation link, please enter your email address here.\"), React.createElement(TextField, {\n      autoFocus: true,\n      margin: \"dense\",\n      id: \"name\",\n      label: \"Email Address\",\n      type: \"email\",\n      fullWidth: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65\n      },\n      __self: this\n    })), React.createElement(DialogActions, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74\n      },\n      __self: this\n    }, React.createElement(Button, {\n      color: \"primary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75\n      },\n      __self: this\n    }, \"Cancel\"), React.createElement(Button, {\n      color: \"primary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78\n      },\n      __self: this\n    }, \"Subscribe\"))), React.createElement(UsersListDisplay, {\n      users: userData,\n      loading: this.state.awaitingData,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    }));\n  }\n\n}\n\nfunction recursiveFind(obj, value, exact) {\n  let json = JSON.stringify(obj);\n  const regex = exact ? new RegExp('\"' + value.toLowerCase() + '\"', \"g\") : new RegExp(\".*\" + value.toLowerCase() + \".*\", \"g\");\n  return json.toLowerCase().search(regex) !== -1;\n}\n\nfunction doFilter(users, filter) {\n  let result = [];\n\n  for (let user of users) {\n    let data = user.resource;\n    let match = [];\n\n    if (filter.name) {\n      match.push(recursiveFind(data.name, filter.name, filter.exactMatch));\n    }\n\n    if (filter.birthdate) {\n      let isWithIn = filter.birthdate[0] <= moment(data.birthDate) && moment(data.birthDate) <= filter.birthdate[1];\n      match.push(isWithIn);\n    }\n\n    if (filter.gender) {\n      match.push(data.gender === filter.gender);\n    }\n\n    if (filter.phone) {\n      match.push(recursiveFind(data.telecom, filter.phone, filter.exactMatch));\n    }\n\n    if (filter.address) {\n      match.push(recursiveFind(data.address, filter.address, filter.exactMatch));\n    }\n\n    if (filter.maritalStatus) {\n      match.push(recursiveFind(data.maritalStatus, filter.maritalStatus, filter.exactMatch));\n    }\n\n    if (filter.id) {\n      match.push(recursiveFind(data.id, filter.id, filter.exactMatch));\n    }\n\n    if (filter.anythingElse) {\n      match.push(recursiveFind(data, filter.anythingElse, filter.exactMatch));\n    } // result\n\n\n    if (match.every(x => x === true)) {\n      result.push(user);\n    }\n  }\n\n  console.log(result);\n  return result;\n}\n\nexport default PortalUsersPage;","map":{"version":3,"sources":["/Users/ibrahimfarajzade/Documents/GitHub/SeniorProject/WebPortal/src/routes/portalUsers.js"],"names":["React","UsersListDisplay","getUserList","Header","Overlay","message","Button","TextField","Dialog","DialogActions","DialogContent","DialogContentText","DialogTitle","moment","require","PortalUsersPage","Component","constructor","props","state","awaitingData","users","page","componentDidMount","json","setState","render","userData","filter","doFilter","length","success","content","duration","warn","isOpen","handleClickOpen","margin","marginTop","recursiveFind","obj","value","exact","JSON","stringify","regex","RegExp","toLowerCase","search","result","user","data","resource","match","name","push","exactMatch","birthdate","isWithIn","birthDate","gender","phone","telecom","address","maritalStatus","id","anythingElse","every","x","console","log"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport UsersListDisplay from \"../components/UsersListDisplay\";\nimport { getUserList } from \"../javascript/api\";\nimport Header from \"../components/Header\";\nimport Overlay from \"../components/Overlay\";\nimport { message, Button } from \"antd\";\nimport TextField from '@material-ui/core/TextField';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\n\nconst moment = require(\"moment\");\n\nclass PortalUsersPage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      awaitingData: true,\n      users: null,\n      page: 0\n    };\n  }\n\n  async componentDidMount() {\n    let json = await getUserList(message);\n\n    this.setState({\n      awaitingData: false,\n      users: json\n    });\n  }\n\n  render() {\n    let userData = this.state.users;\n    if (this.props.filter && this.state.users) {\n      userData = doFilter(this.state.users, this.props.filter);\n      if (userData.length > 0) {\n        message.success({ content: `Found ${userData.length} matching records`, duration: 3 });\n      } else {\n        message.warn({ content: `No records found`, duration: 3 });\n      }\n    }\n\n    const state = {isOpen:false};\n\n    const handleClickOpen = () => {\n      state.isOpen(true)\n    };\n\n    return (\n      <div>\n        <Overlay show={this.state.awaitingData}></Overlay>\n        {!this.props.filter && <Header title=\"Portal Users List\"></Header>}\n        <Button style={{ margin: 10, marginTop: -10 }} type=\"primary\" htmlType=\"submit\" onClick={handleClickOpen}>\n            Add User\n          </Button>\n          <Dialog aria-labelledby=\"form-dialog-title\">\n        <DialogTitle id=\"form-dialog-title\">Subscribe</DialogTitle>\n        <DialogContent>\n          <DialogContentText>\n            To send invitation link, please enter your email address here.\n          </DialogContentText>\n          <TextField\n            autoFocus\n            margin=\"dense\"\n            id=\"name\"\n            label=\"Email Address\"\n            type=\"email\"\n            fullWidth\n          />\n        </DialogContent>\n        <DialogActions>\n          <Button color=\"primary\">\n            Cancel\n          </Button>\n          <Button color=\"primary\">\n            Subscribe\n          </Button>\n        </DialogActions>\n      </Dialog>\n        <UsersListDisplay users={userData} loading={this.state.awaitingData} />\n      </div>\n    );\n  }\n}\n\nfunction recursiveFind(obj, value, exact) {\n  let json = JSON.stringify(obj);\n  const regex = exact\n    ? new RegExp('\"' + value.toLowerCase() + '\"', \"g\")\n    : new RegExp(\".*\" + value.toLowerCase() + \".*\", \"g\");\n  return json.toLowerCase().search(regex) !== -1;\n}\n\nfunction doFilter(users, filter) {\n  let result = [];\n  for (let user of users) {\n    let data = user.resource;\n    let match = [];\n    if (filter.name) {\n      match.push(recursiveFind(data.name, filter.name, filter.exactMatch));\n    }\n    if (filter.birthdate) {\n      let isWithIn =\n        filter.birthdate[0] <= moment(data.birthDate) &&\n        moment(data.birthDate) <= filter.birthdate[1];\n      match.push(isWithIn);\n    }\n    if (filter.gender) {\n      match.push(data.gender === filter.gender);\n    }\n    if (filter.phone) {\n      match.push(recursiveFind(data.telecom, filter.phone, filter.exactMatch));\n    }\n    if (filter.address) {\n      match.push(recursiveFind(data.address, filter.address, filter.exactMatch));\n    }\n    if (filter.maritalStatus) {\n      match.push(recursiveFind(data.maritalStatus, filter.maritalStatus, filter.exactMatch));\n    }\n    if (filter.id) {\n      match.push(recursiveFind(data.id, filter.id, filter.exactMatch));\n    }\n    if (filter.anythingElse) {\n      match.push(recursiveFind(data, filter.anythingElse, filter.exactMatch));\n    }\n\n    // result\n    if (match.every(x => x === true)) {\n      result.push(user);\n    }\n  }\n  console.log(result);\n  return result;\n}\n\nexport default PortalUsersPage;\n"]},"metadata":{},"sourceType":"module"}